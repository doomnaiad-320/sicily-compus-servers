<t-toast id="t-toast" />

<view class="my">
  <image class="nav-bg" src="/static/bg_navbar.png" />
  <nav title-text="我的" />
  <view class="my-info">
    <t-cell-group>
      <t-cell wx:if="{{isLoad}}" bordered="{{false}}">
        <t-avatar icon="user" slot="left-icon" size="large" />
        <view class="my-info__person" slot="description">
          <view class="name">{{personalInfo.nickname || '用户'}}</view>
          <view class="tags">
            <t-tag class="tag" variant="light">{{personalInfo.currentRole === 'worker' ? '兼职者' : '用户'}}</t-tag>
            <!-- 兼职者审核状态标签（仅在兼职者模式下显示） -->
            <t-tag wx:if="{{personalInfo.currentRole === 'worker' && personalInfo.worker && personalInfo.worker.status === 'approved'}}" class="tag" variant="light" theme="success">已通过审核</t-tag>
            <t-tag wx:elif="{{personalInfo.currentRole === 'worker' && personalInfo.worker && personalInfo.worker.status === 'pending'}}" class="tag" variant="light" theme="warning">审核中</t-tag>
            <t-tag wx:elif="{{personalInfo.currentRole === 'worker' && personalInfo.worker && personalInfo.worker.status === 'rejected'}}" class="tag" variant="light" theme="danger">未通过</t-tag>
          </view>
        </view>
        <!-- 只有审核通过的兼职者才显示切换按钮 -->
        <t-button
          wx:if="{{personalInfo.worker && personalInfo.worker.status === 'approved'}}"
          size="small"
          variant="outline"
          theme="primary"
          loading="{{roleSwitching}}"
          bindtap="onSwitchRole"
          slot="right-icon"
        >
          切换
        </t-button>
      </t-cell>
      <t-cell
        wx:if="{{!isLoad}}"
        title="请先登录/注册"
        bordered="{{false}}"
        t-class-title="cell-class-title"
        t-class-center="cell-class-center"
        bindtap="onLogin"
      >
        <t-avatar slot="left-icon" icon="user" size="128rpx" />
      </t-cell>
    </t-cell-group>
    <t-divider t-class="divider-class" />
    <t-grid t-class="grid-class">
      <t-grid-item
        wx:for="{{gridList}}"
        wx:for-item="gridItem"
        wx:key="type"
        text="{{gridItem.name}}"
        icon="{{gridItem.icon}}"
        class="grid-item {{gridItem.type === 'all' ? 'split-line' : ''}}"
        data-data="{{gridItem}}"
        bindclick="onEleClick"
      />
    </t-grid>
  </view>
</view>
